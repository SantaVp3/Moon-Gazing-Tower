# 移动端与小程序扫描

Moon-Gazing-Tower 集成了强大的企业资产发现能力，支持对 APP（移动应用）、微信小程序、微信公众号等移动端资产进行自动化收集和扫描。

## 核心能力

该模块基于 [ENScan_GO](https://github.com/wgpsec/ENScan_GO) 工具进行封装，能够通过企业名称快速反查其旗下的移动端资产。

### 1. APP 资产发现
自动收集企业发布的移动应用信息：
- **基本信息**: APP 名称、图标、版本号、更新时间。
- **应用市场**: 覆盖主流应用商店（华为、小米、应用宝、AppStore 等）。
- **包名信息**: Android 包名 (Package Name) 和 iOS Bundle ID。
- **下载地址**: 获取 APK 下载链接或商店页面链接。

### 2. 小程序资产发现
自动收集企业注册的微信小程序：
- **基本信息**: 小程序名称、AppID、Logo。
- **分类信息**: 所属行业分类。
- **二维码**: 获取小程序码，方便扫码测试。

### 3. 公众号资产发现
自动收集企业运营的微信公众号：
- **基本信息**: 公众号名称、微信号、简介。
- **认证状态**: 是否已通过微信认证。

## 使用指南

### 配置 ENScan

在使用前，需要配置 ENScan 的数据源 Cookie，以确保查询的准确性和稳定性。

编辑 `config/tools/enscan.yaml` (或在系统设置界面配置)：

```yaml
cookies:
  aiqicha: "YOUR_AIQICHA_COOKIE"     # 爱企查 Cookie
  tianyancha: "YOUR_TIANYANCHA_COOKIE" # 天眼查 Cookie
  qimai: "YOUR_QIMAI_COOKIE"         # 七麦数据 Cookie (用于 APP 查询)
```

### 发起扫描

1. **创建任务**: 在任务管理页面，选择 "企业资产扫描" 或 "ENScan" 任务类型。
2. **输入目标**: 输入目标企业的**全称**（如 "深圳市腾讯计算机系统有限公司"）。
3. **选择模块**: 勾选需要查询的模块（APP、小程序、公众号等）。
4. **开始扫描**: 系统将自动调用 ENScan 进行查询，并将结果存入资产库。

### 资产管理

扫描完成后，发现的资产将自动分类存储：

- **APP**: 归类为 `APP` 类型资产，可查看包名、版本等详情。
- **小程序**: 归类为 `MiniProgram` 类型资产，可查看 AppID 等详情。

## 进阶应用

### 1. 资产关联
系统会自动将发现的 APP 和小程序与所属的主企业资产进行关联，形成完整的资产拓扑图。

### 2. 漏洞扫描 (规划中)
未来版本将支持对发现的 APP 和小程序进行进一步的安全检测：
- **APP**: 自动化下载 APK 并进行静态分析 (SAST) 和动态分析 (DAST)。
- **小程序**: 自动化反编译和代码审计。
